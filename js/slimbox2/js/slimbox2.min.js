!function(i){var e,t,n,l,o,a,r,s,d,c,h,u,p,f,y,g,v,m,b,w,x,k,I=i(window),L=-1,D=!window.XMLHttpRequest,T=[],z=(document.documentElement,{}),N=new Image,H=new Image;function K(){var e=I.scrollLeft(),t=I.width();i([p,b]).css("left",e+t/2),a&&i(u).css({left:e,top:I.scrollTop(),width:t,height:I.height()})}function C(e){e?i("object").add(D?"select":"embed").each(function(i,e){T[i]=[e,e.style.visibility],e.style.visibility="hidden"}):(i.each(T,function(i,e){e[0].style.visibility=e[1]}),T=[]);var t=e?"bind":"unbind";I[t]("scroll resize",K),i(document)[t]("keydown",E)}function E(t){var n=t.which,l=i.inArray;return l(n,e.closeKeys)>=0?A():l(n,e.nextKeys)>=0?M():l(n,e.previousKeys)>=0?F():null}function F(){return O(l)}function M(){return O(o)}function O(i){return i>=0&&(n=t[L=i][0],l=(L||(e.loop?t.length:0))-1,o=(L+1)%t.length||(e.loop?0:-1),q(),p.className="lbLoading",(z=new Image).onload=S,z.src=n),!1}function S(){if(p.className="",0!=e.scaler){var a=e.scaler*Math.min(i(window).width()/z.width,i(window).height()/z.height);1!=a&&(z.width*=a,z.height*=a),i(y).attr({src:n}),i(f).css({visibility:"hidden",display:""})}else i(f).css({backgroundImage:"url("+n+")",visibility:"hidden",display:""});i(g).width(z.width),i([g,v,m]).height(z.height),i(x).html(t[L][1]||""),i(k).html((t.length>1&&e.counterText||"").replace(/{x}/,L+1).replace(/{y}/,t.length)),l>=0&&(N.src=t[l][0]),o>=0&&(H.src=t[o][0]),s=f.offsetWidth,d=f.offsetHeight;var c=Math.max(0,r-d/2);p.offsetHeight!=d&&i(p).animate({height:d,top:c},e.resizeDuration,e.resizeEasing),p.offsetWidth!=s&&i(p).animate({width:s,marginLeft:-s/2},e.resizeDuration,e.resizeEasing),i(p).queue(function(){i(b).css({width:s,top:c+d,marginLeft:-s/2,visibility:"hidden",display:""}),i(f).css({display:"none",visibility:"",opacity:""}).fadeIn(e.imageFadeDuration,W)})}function W(){l>=0&&i(v).show(),o>=0&&i(m).show(),i(w).css("marginTop",-w.offsetHeight).animate({marginTop:0},e.captionAnimationDuration),b.style.visibility=""}function q(){z.onload=null,z.src=N.src=H.src=n,i([p,f,w]).stop(!0),i([v,m,f,b]).hide()}function A(){return L>=0&&(q(),L=l=o=-1,i(p).hide(),i(u).stop().fadeOut(e.overlayFadeDuration,C)),!1}i.slimbox=function(n,l,o){return e=i.extend({loop:!1,overlayOpacity:.8,overlayFadeDuration:400,resizeDuration:400,resizeEasing:"swing",initialWidth:250,initialHeight:250,slideInterval:0,scaler:.75,imageFadeDuration:400,captionAnimationDuration:400,counterText:"Image {x} of {y}",closeKeys:[27,88,67],previousKeys:[37,80],nextKeys:[39,78]},o),null==document.querySelector("#lbCenter")&&(i("body").append(i([u=i('<div id="lbOverlay" />').click(A)[0],p=i('<div id="lbCenter" />')[0],b=i('<div id="lbBottomContainer" />')[0]]).css("display","none")),0!=e.scaler?(f=i('<div id="lbImage" />').appendTo(p).append(g=i('<div style="position: relative;" />').append([y=i('<img id="lbSlide" src="" alt="" />')[0],m=i('<a id="lbNextLink" href="#" />').click(M)[0]])[0],v=i('<a id="lbPrevLink" href="#" />').click(F)[0])[0],window.nextlink=document.getElementById("lbNextLink")):f=i('<div id="lbImage" />').appendTo(p).append(g=i('<div style="position: relative;" />').append([m=i('<a id="lbNextLink" href="#" />').click(M)[0]])[0],v=i('<a id="lbPrevLink" href="#" />').click(F)[0])[0],w=i('<div id="lbBottom" />').appendTo(b).append([i('<a id="lbCloseLink" href="#" />').click(A)[0],x=i('<div id="lbCaption" />')[0],k=i('<div id="lbNumber" />')[0],i('<div style="clear: both;" />')[0]])[0]),"string"==typeof l&&(l=Number(l)),"string"==typeof n&&(n=[[n,l]],l=0),r=I.scrollTop()+I.height()/2,s=e.initialWidth,d=e.initialHeight,c=e.slideInterval,i(p).css({top:Math.max(0,r-d/2),width:s,height:d,marginLeft:-s/2}).show(),(a=D||u.currentStyle&&"fixed"!=u.currentStyle.position)&&(u.style.position="absolute"),i(u).css("opacity",e.overlayOpacity).fadeIn(e.overlayFadeDuration),K(),C(1),t=n,e.loop=e.loop&&t.length>1,c>0?h=setInterval(function(){M()},1e3*c):clearInterval(h),O(l)},i.fn.slimbox=function(t,n,l){n=n||function(i){return[i.href,i.title]},l=l||function(){return!0};var o=this;return e=i.extend({slideInterval:0},t),c=e.slideInterval,o.unbind("click").click(function(){var e,a,r=this,s=0,d=0;for(a=(e=i.grep(o,function(i,e){return l.call(r,i,e)})).length;d<a;++d)e[d]==r&&(s=d),e[d]=n(e[d],d);return i.slimbox(e,s,t)})}}(jQuery);